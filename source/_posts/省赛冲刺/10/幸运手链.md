---
title: 幸运手链
date: 2025-02-15 19:05:40
tags:
    - C++
    - 前缀和
---

### 题目描述

小科准备为自己做一条幸运手链。小科有 $N$（$1 \leq N \leq 10^6$）颗宝石。小科把它们摆成一排，从左往右依次编号为 $1 \ldots N$。每颗宝石都有一个价值，编号为 $i$ 的宝石的价值为 $v_i$ ($1 \leq v_i \leq 10^6$)。小科喜欢数字 $6$，所以他希望选出的宝石的价值之和是 $6$ 的倍数。他只会挑选编号连续的宝石。并且他希望最终项链上的宝石越多越好。请帮助小科计算他可以制作的幸运手链中宝石的最大数量。如果无法制作幸运手链，输出 $0$。

### 输入格式

- 第 1 行：一个整数 $N$
- 第 2 到 $N$ 行，每行一个整数，其中第 $i+1$ 行的整数 $v_i$，表示编号为 $i$ 的宝石的价值。

### 输出格式

- 一行：一个整数，表示小科制作的幸运手链可以包含的最大宝石数量。

### 输入输出样例

#### 输入样例 1

```plaintext
5
6 6 6 6 6
```

#### 输出样例 1

```plaintext
5
```

#### 输入样例 2

```plaintext
5
2 6 5 6 4
```

#### 输出样例 2

```plaintext
1
```

#### 输入样例 3

```plaintext
5
7 7 7 7 7
```

#### 输出样例 3

```plaintext
0
```

## 题解

尝试暴力枚举......

```c++
//前缀和略
for(ll i = 1; i <= n; i++) {
    for(ll j = i; j <= n; j++) {
        if((sum[j] - sum[i-1]) % 6 == 0) {
            //计算结果
        }
    }
}
```

不妨假设 $[i,j]$ 的和是 $6$ 的倍数，那么有：

$$
\begin{equation}\begin{split}
s_j - s_i &\equiv 0 \ (mod \ 6) \\
s_j \ mod \ 6 - s_i \ mod \ 6 &= 0 \\
s_j &\equiv s_i \ ( mod \ 6)
\end{split}\end{equation}
$$

所以我们让 $s$ 整体对 $6$ 取余，找出差最大的 $l,r$ 使 $s_r = s_l$，区间长度即为 $r-l$。

```c++
#include <bits/stdc++.h>
using namespace std;

#define ll long long


//f[i]记录s中第一个等于i的下标
ll n, v[1000010], f[6];

int main() {
    cin >> n;
    for(ll i = 1; i <= n; i++) cin >> v[i];
    
    ll sum = 0, ans = 0;
    for(ll i = 1; i <= n; i++) {
        sum += v[i];
        sum %= 6;
        //本身能整除6
        if(sum == 0) ans = max(ans, i);
        //出现过sum
        else if(f[sum]) ans = max(ans, i - f[sum]);
        //记录
        else f[sum] = i;
    }
    cout << ans << endl;
}
```
