---
title: K阶恒星系
date: 2025-02-15 18:04:09
tags:
    - C++
    - 优先队列
    - 堆
---

## 题目描述

半人马座 A 是个巨大的椭圆星系，具有 $n$ 个恒星。和太阳系一样，每个恒星周围都有许多行星。小可可团队通过太空望远镜，观测出每个恒星系里行星的数量，其中第 $i$ 个恒星系里有 $p_i(1 ≤ i ≤ n)$ 个行星。若第 $i$ 个恒星系为小可可定义的 $k$ 阶恒星系，则在正整数序列 $p_1,p_2,... p_n$ 中，$p_i$ 的左边和右边都至少有 $k$ 个元素的值小于 $p_i$（如图 $1$ 所示）。

![](http://cdl-asset.oss-cn-beijing.aliyuncs.com/online/e74fd729b28486703c5b273694649c37.png)


(备注：上图打印有误，实际下标应是 $p_1,p_2,p_3,......,p_{i-1},p_i,p_{i+1},p_{i+2},......,p_n$。)

现在，小可可请你统计出半人马座 A 中 $k$ 阶恒星系的数量。

## 输入格式

输入数据有 $2$ 行，第一行输入 $2$ 个正整数 $n, k$，分别表示恒星的数量和满足定义的 $k$ 值。

第二行：由 $n$ 个正整数构成的序列 $p_1,p_2,..., p_n$。

## 输出格式

一行一个正整数，表示半人马座 A 中 $k$ 阶恒星系的数量。

## 输入输出样例 #1

### 输入 #1

```
10 2
8 8 10 7 4 8 2 1 7 4
```

### 输出 #1

```
2
```

## 输入输出样例 #2

### 输入 #2

```
20 3
15 8 15 5 9 8 11 12 7 4 3 11 15 6 20 11 2 11 1 13
```

### 输出 #2

```
5
```

## 说明/提示

### 解释#1

红色的数字代表 $k$ 阶恒星系：$8\ 8$ `10` $7\ 4$ `8` $2\ 1\ 7\ 4$。
### 解释#2

红色的数字代表 $k$ 阶恒星系：$15\ 8\ 15\ 5\ 9\ 8$ `11` `12` $7\ 4\ 3$ `11` `15` $6$ `20` $11\ 2\ 11\ 1\ 13$。
## 数据范围

对于所有数据，$1000 ≤ n ≤ 10^6$，$50 ≤ k ≤ 10^5$，$1 ≤ p_i ≤ n$。

| 测试点编号 |  $n≤$  |
| :--------: | :----: |
|    $1\sim 4$     | $10^4$ |
|    $5\sim 9$     | $10^5$ |
|   $10\sim 20$    | $10^6$ |
