---
title: 快速幂
date: 2024-08-31 16:01:10
tags: C++
categories:
    - [算法,数论]
---

对于正整数$a, b, k$，求$a^b \mod k$。

如果直接算$a^b$再对$k$取模，那么时间复杂度为$\mathbf{O}(b)$

<video controls src="/videos/快速幂动画.mp4" title="快速幂动画"></video>

快速幂主要是利用了二进制的性质，将$a^b$写成：
$$
a^b = a^{2^{x_1}} + a^{2^{x_2}} + \dots + a^{2^{x_{log_2b}}}
$$

例：求$5^{10} \mod 2$

已知10的二进制为：


|16| 8| 4| 2| 1|
|-|-|-|-|-|
| 0| 1| 0| 1| 0|

原式转换为：$(5^8 \times 5^2) \mod 2$

而在计算机中，拆分$b$的为二进制，就是不断让$b$对$2$取余，然后$b$除以$2$。

代码：
```c++
unsigned long long FastPow(int a, int b, int k) {
    unsigned long long ans = 1;
    while(b) {      
        if(b % 2) ans = (ans * a) % k;  
        a = (a * a) % k;    
        b /= 2;             
    }
    return ans;
}
```
P10995