---
title: 扩展欧几里得算法
date: 2024-11-23 21:44:47
tags:
---

## 前置知识

欧几里得算法求 $gcd$：
$$
gcd(a,b)\left\{ 
\begin{aligned}
& a, & b=0 \\
& gcd(b, a\mod b) & b \neq 0
\end{aligned}
\right.
$$

Code:

```c++
int gcd(int a, int b) {
    if(b == 0) return a;
    return gcd(b, a%b);
}
```

## 问题描述

对于 $ax+by=gcd(a,b)$，求 $x,y (x,y \in \mathbb{Z})$。

## 求解过程

- 当 $b=0$ 时：
    $$
    ax=a
    $$

    求得：
    $$
    \left\{ 
    \begin{aligned}
    & x=1, \\
    & y=0
    \end{aligned}
    \right.
    $$

- 当 $b \neq 0$ 时：

    $$
    ax+by=gcd(a,b), (1)
    $$

    根据欧几里得算法，求得：
    $$
    bx_1+(a \mod b)y_1=gcd(b,a \mod b)
    $$

    将模运算替换：
    $$
    bx_1+(a- \lfloor{\frac{a}{b}}\rfloor{b})y_1=gcd(b,a \mod b)
    $$

    $$
    bx_1+ay_1-\lfloor{\frac{a}{b}}\rfloor{b}y_1=gcd(b, a \mod b)
    $$

    因式分解，提出公因式 $b$：

    $$
    ay_1+b(x_1-\lfloor{\frac{a}{b}}\rfloor{}y_1)=gcd(b,a\mod{b}), (2)
    $$

    对比 $(1)$ 式与 $(2)$ 式，发现
    $$
    \left\{ 
    \begin{aligned}
    & x=y_1, \\
    & y=x_1-\lfloor{\frac{a}{b}}\rfloor{}y_1
    \end{aligned}
    \right.
    $$

    可以发现，求 $x,y$ 的过程是可以递归的。

    当进行 $k$ 轮递归后，等式右边变为 $gcd(b_k,0)$，有：
    $$
    \left\{ 
    \begin{aligned}
    & x_k=1, \\
    & y_k=0
    \end{aligned}
    \right.
    $$

    对于 $x_i$ 与 $y_i$ $(i \neq k)$，有：
    
    $$
    \left\{ 
    \begin{aligned}
    & x_i=y_{i+1}, \\
    & y_i=x_{i+1}-\lfloor{\frac{a}{b}}\rfloor{}y_{i+1}
    \end{aligned}
    \right.
    $$

    此时，将 $y_k, x_k$ 反向代入 $x_{k-1}, y_{k-1}, \cdots, x_1, y_1$，即可求出 $x, y$。

## 代码

定义`exgcd(a,b,x,y)`，表示求 $ax+by=gcd(x,y)$ 的最小正整数解，其返回值表示 $gcd(a,b)$。

```c++
//注释是从一层递归的角度写的
int exgcd(int a, int b, int &x, int &y) {
    if(!b) {    //递归边界
        x=1, y=0;
        return a;
    }
    //递归求得x[k]与y[k]并回代，相当于取得x[1]与y[1]
    int d = exgcd(b, a%b, x, y);    //此时x代表x[1]，y代表y[1]
    //递归函数，将y[1]带入解x
    int t = x; x = y;               //此时x代表解x，即解x=y[1]
    //递归函数，
    y = t - a/b*y;                  //此时y代表解y，即解y=x[1]-a/b*y[1]
    //两个未知数代完后，递归回代，相当于从第9行再开始一次
    return d;                       //返回gcd(a,b)
}
```

调用演示：

```c++
int x, y;
/*int ans=*/exgcd(/*a的值*/,/*b的值*/,x,y);
```
